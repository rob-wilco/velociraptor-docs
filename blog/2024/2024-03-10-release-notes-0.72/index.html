<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.122.0"><meta name=description content="Velociraptor Release 0.72 is now in release candidate status.
This post discusses some of the new features.
"><link rel=icon href=/images/favicon.png type=image/png><title>Velociraptor 0.72 Release :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1711319563 rel=stylesheet><link href=/css/fontawesome-all.min.css?1711319563 rel=stylesheet><link href=/css/featherlight.min.css?1711319563 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1711319563 rel=stylesheet><link href=/css/auto-complete.css?1711319563 rel=stylesheet><link href=/css/theme.css?1711319563 rel=stylesheet><link href=/css/tabs.css?1711319563 rel=stylesheet><link href=/css/hugo-theme.css?1711319563 rel=stylesheet><link href=/css/theme-mine.css?1711319563 rel=stylesheet><link href=/css/dark.css?1711319563 rel=stylesheet><link href=/css/syntax.css?1711319563 rel=stylesheet><link href=/css/light.css?1711319563 rel=stylesheet><link href=/css/hljs.css?1711319563 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1711319563 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1711319563></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYH72LMYCS",{anonymize_ip:!1})}</script><script>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-QYH72LMYCS","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><script></script></head><body data-url=/blog/2024/2024-03-10-release-notes-0.72/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp("theme=darkmode");regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a></div><ul><li data-nav-id=https://docs.velociraptor.app/announcements/2023-cves/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2023-cves/>Current CVEs</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/orgs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/orgs/>Organizations</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/security/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/security/>Security</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/deployment/references/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/references/>Config Reference</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/remote_uploads/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/remote_uploads/>Remote Uploads</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a></div></li></ul></li></ul></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a></div></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item parent haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a></div><ul><li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_auscert/>Auscert 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_us/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_us/>DFRWS US 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_tech_user_group_cbr/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_tech_user_group_cbr/>Tech Users Group 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_sans_summit/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_sans_summit/>SANS Summit 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_velocon/>Velocon 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2022_dfrws_apac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_dfrws_apac/>DFRWS APAC 2022</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_everything_open/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_everything_open/>EverythingOpen 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_auscert/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_auscert/>Auscert 2023</a></div></li><li data-nav-id=https://docs.velociraptor.app/presentations/2023_velocon/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2023_velocon/>VeloCON 2023</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/artifact_references/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/artifact_references/><i class="fas fa-book"></i>Artifact Reference</a></div></li><li data-nav-id=https://docs.velociraptor.app/knowledge_base/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/knowledge_base/><i class="fas fa-brain"></i>Knowledge Base</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class='fas fa-search'></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class='fab fa-github'></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class='fab fa-discord'></i>Discord</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class='fas fa-envelope'></i>Mailing List</a></li><li><a class=padding href=https://docs.velociraptor.app/rss/><i class='fas fa-rss'></i>RSS</a></li><li><a class=padding href=https://docs.rapid7.com/><i class='fa fa-question-circle'></i>Rapid7 Docs</a></li></ul></section><section id=footer><div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2022</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title='Edit this page' href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/blog/2024/2024-03-10-release-notes-0.72/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Velociraptor 0.72 Release</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#ewf-support>EWF Support</a></li><li><a href=#allow-remapping-clients-to-use-ssh-accessor>Allow remapping clients to use SSH accessor</a></li><li><a href=#gui-changes>GUI Changes</a><ul><li><a href=#undoredo-for-notebook-cells>Undo/Redo for notebook cells</a></li><li><a href=#hunt-view-gui-is-now-paged>Hunt view GUI is now paged</a></li></ul></li><li><a href=#secret-management>Secret Management</a></li><li><a href=#server-improvements>Server improvements</a><ul><li><a href=#implemented-websocket-based-communication-mechanism>Implemented Websocket based communication mechanism</a></li><li><a href=#dynamic-dns-providers>Dynamic DNS providers</a></li><li><a href=#enhanced-proxy-support>Enhanced proxy support</a></li></ul></li><li><a href=#other-notable-features>Other notable features</a><ul><li><a href=#process-memory-access-on-macos>Process memory access on MacOS</a></li><li><a href=#multipart-uploaders-to-http_client>Multipart uploaders to http_client()</a></li><li><a href=#yara-plugin-can-now-accept-compiled-rules>Yara plugin can now accept compiled rules</a></li></ul></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/release>Release</a></div></div><div id=body-inner><h1>Velociraptor 0.72 Release</h1><div class="author pull-right">Mike Cohen
<span class=date>2024-03-10</span></div><p>I am very excited to announce that the latest Velociraptor release
0.72 is now available for testing in Release Candidate status.</p><p>In this post I will discuss some of the interesting new features.</p><h2 id=ewf-support>EWF Support</h2><p>Velociraptor has introduced the ability to analyze dead disk images in
the past. Although we don&rsquo;t need to analyze disk images very often,
the need comes up occasionally.</p><p>While previously Velociraptor only supported analysis of DD images
(AKA &ldquo;Raw images&rdquo;). Most people use a standard acquisition software to
acquire the image which uses the common EWF format to compress the
image.</p><p>In this release, Velociraptor supports EWF (AKA E01) format using the
<code>ewf</code> accessor. This allows Velociraptor to analyze E01 image sets.</p><p>To analyse dead disk images use the following steps:</p><ol><li><p>Create a remapping configuration that maps the disk accessors into
the E01 image. This automatically diverts VQL functions that look
at the filesystem into the image instead of using the host&rsquo;s
filesystem. In this release you can just point the
<code>--add_windows_disk</code> option to the first disk of the EWF disk set
(the other parts are expected to be in the same directory and will
be automatically loaded).</p><p>The following creates a remapping file by recognizing the windows
partition in the disk image.</p><pre><code class=language-sh>$ velociraptor-v0.72-rc1-linux-amd64  deaddisk \
   --add_windows_disk=/tmp/e01/image.E01 /tmp/remapping.yaml -v
</code></pre></li><li><p>Next we launch a client with the remapping file. This causes any
VQL queries that access the filesystem to come from the image
instead of the host. Other than that the client looks like a
regular client and will connect to the Velociraptor server just
like any other client. To ensure that this client is unique you can
override the writeback location (where the client id is stored) to
a new file.</p><pre><code class=language-sh>$ velociraptor-v0.72-rc1-linux-amd64  --remap /tmp/remapping.yaml \
   --config ~/client.config.yaml client -v \
   --config.client-writeback-linux=/tmp/remapping.writeback.yaml
</code></pre></li></ol><p><img src=ewf.png alt></p><h2 id=allow-remapping-clients-to-use-ssh-accessor>Allow remapping clients to use SSH accessor</h2><p>Sometimes we can not deploy the Velociraptor client on a remote
system. For example, it might be an edge device like an embedded Linux
system or it may not be directly supported by Velociraptor.</p><p>In 0.7.1, Velociraptor introduced the <code>ssh</code> accessor which allows VQL
queries to use a remote <code>ssh</code> connection to access remote files.</p><p>This release added the ability to apply remapping in a similar way to
the dead disk image method above to run a <code>Virtual Client</code> which
connects to the remote system via SSH and emulates filesystem access
over the <code>sftp</code> protocol.</p><p>To use this feature you can write a remapping file that maps the ssh
accessor instead of the <code>file</code> and <code>auto</code> accessors:</p><pre><code class=language-yaml>remappings:
- type: permissions
  permissions:
  - COLLECT_CLIENT
  - FILESYSTEM_READ
  - READ_RESULTS
  - MACHINE_STATE
- type: impersonation
  os: linux
  hostname: RemoteSSH
- type: mount
  scope: |
    LET SSH_CONFIG &lt;= dict(hostname='localhost:22',
      username='test',
      private_key=read_file(filename='/home/test/.ssh/id_rsa'))

  from:
    accessor: ssh

  &quot;on&quot;:
    accessor: auto
    path_type: linux

- type: mount
  scope: |
    LET SSH_CONFIG &lt;= dict(hostname='localhost:22',
      username='test',
      private_key=read_file(filename='/home/test/.ssh/id_rsa'))

  from:
    accessor: ssh

  &quot;on&quot;:
    accessor: file
    path_type: linux
</code></pre><p>Now you can start a client with this remapping file to virtualize
access to the remote system via SSH.</p><pre><code>$ velociraptor-v0.72-rc1-linux-amd64  --remap /tmp/remap_ssh.yaml \
   --config client.config.yaml client -v \
   --config.client-writeback-linux=/tmp/remapping.writeback_ssh.yaml \
   --config.client-local-buffer-disk-size=0
</code></pre><p><img src=ssh.png alt></p><h2 id=gui-changes>GUI Changes</h2><p>The GUI has been improved in this release.</p><h3 id=undoredo-for-notebook-cells>Undo/Redo for notebook cells</h3><p>Velociraptor offers an easy way to experiment and explore data with
VQL queries in the notebook interface. Naturally exploring the data
requires going back and forth between different VQL queries.</p><p>In this release, Velociraptor keeps several versions of each VQL cell
(by default 5) so as users explore different queries they can easily
undo and redo queries. This makes exploring data much quicker as you
can go back to a previous version instantly.</p><p><img src=undo-redo.png alt></p><h3 id=hunt-view-gui-is-now-paged>Hunt view GUI is now paged</h3><p>Previously hunts were presented in a table with limited size. In this
release, the hunt table is paged and searchable/sortable. This brings
the hunts table into line with the other tables in the interface and
allows an unlimited number of hunts to be viewable in the system.</p><p><img src=hunt_table.png alt></p><h2 id=secret-management>Secret Management</h2><p>Many Velociraptor plugins require secrets to operate. For example, the
<code>ssh</code> accessor requires a private key or password to log into the
remote system. Similarly the <code>s3</code> or <code>smb</code> accessors requires
credentials to upload to the remote file servers. Many connections
made over the <code>http_client()</code> plugin require authorization - for
example an API key to send <code>Slack</code> messages or query remote services
like <code>Virus Total</code>.</p><p>Previously plugins that required credentials needed those credentials
to be passed as arguments to the plugin. For example, the
<a href=https://docs.velociraptor.app/vql_reference/plugin/upload_s3/>upload_s3()</a>
plugin requires AWS S3 credentials to be passed in as parameters.</p><p>This poses a problem for the Velociraptor artifact writer - how to
safely provide the credentials to the VQL query in a way that does not
expose them to every user of the Velociraptor GUI? If the credentials
are passed as parameters to the artifact then they are visible in the
query logs and request etc.</p><p>This release introduces <code>Secrets</code> as a first class concept within
VQL. A <code>Secret</code> is a specific data object (key/value pairs) given a
name which is used to configure credentials for certain plugins:</p><ol><li>A Secret has a <code>name</code> which we use to refer to it in plugins.</li><li>Secrets have a <code>type</code> to ensure their data makes sense to the
intended plugin. For example a secret needs certain fields for
consumption by the <code>s3</code> accessor or the <code>http_client()</code> plugin.</li><li>Secrets are shared with certain users (or are public). This
controls who can use the secret within the GUI.</li><li>The GUI is careful to not allow VQL to read the secrets
directly. The secrets are used by the VQL plugins internally and
are not exposed to VQL users (like notebooks or artifacts).</li></ol><p>Let&rsquo;s work through an example of how Secrets can be managed within
Velociraptor. In this example we store credentials for the <code>ssh</code>
accessor to allow users to <code>glob()</code> a remote filesystem within the
notebook.</p><p>First I will select <code>manage server secrets</code> from the welcome page.</p><p><img src=manage_secrets.png alt></p><p>Next I will choose the <code>SSH PrivateKey</code> secret type and add a new
secret.</p><p><img src=adding_new_secret.png alt></p><p>This will use the secret template that corresponds to the SSH private
keys. The acceptable fields are shown in the GUI and a validation VQL
condition is also shown for the GUI to ensure that the secret is
properly populated. I will name the secret <code>DevMachine</code> to remind me
that this secret allows access to my development system. Note that the
hostname requires both the IP address (or dns name) and the port.</p><p><img src=adding_new_secret_2.png alt></p><p>Next I will share the secrets with some GUI users</p><p><img src=edit_secret.png alt></p><p><img src=share_secret.png alt></p><p>I can view the list of users that are able to use the secret within
the GUI</p><p><img src=viewing_share_secret.png alt></p><p>Now I can use the new secret by simply referring to it by name:</p><p><img src=using_secret.png alt></p><p>Not only is this more secure but it is also more convenient since we
don&rsquo;t need to remember the details of each secret to be able to use
it. For example, the <code>http_client()</code> plugin will fill the URL field,
headers, cookies etc directly from the secret without us needing to
bother with the details.</p><div class="mynotices warning"><div heading=warning><p>Although <code>secrets</code> are designed to control access to the raw
credential by preventing users from directly accessing the secrets'
contents, those secrets are still written to disk. This means that GUI
users with direct filesystem access can simply read the secrets from
the disk.</p><p>We recommend not granting untrusted users elevated server permissions
like <code>EXECVE</code> or <code>Filesystem Read</code> as it can bypass the security
measures placed on secrets.</p></div></div><h2 id=server-improvements>Server improvements</h2><h3 id=implemented-websocket-based-communication-mechanism>Implemented Websocket based communication mechanism</h3><p>One of the most important differences between Velociraptor and some
older remote DFIR frameworks such as GRR is the fact that Velociraptor
maintains a constant, low latency connection to the server. This
allows Velociraptor clients to respond immediately without needing to
wait for polling on the server.</p><p>In order to enhance compatibility between multiple network
configurations, like MITM proxies, transparent proxies etc,
Velociraptor has stuck to simple HTTP based communications
protocols. To keep a constant connection, Velociraptor uses the long
poll method, keeping HTTP POST operations open for a long time.</p><p>However as the Internet evolves and newer protocols become commonly
used by major sites, the older HTTP based communication method has
proved more difficult to use. For example, we found that certain layer
7 load balancers interfere with the long poll method by introducing
buffering to the connection. This severely degrades communications
between client and server (Velociraptor falls back to a polling method
in this case).</p><p>On the other hand, modern protocols are more widely used, so we found
that modern load balancers and proxies already support standard low
latency communications protocol such as <code>Web Sockets</code>.</p><p>In this release, Velociraptor introduces support for websockets as a
communications protocol. The websocket protocol is designed for low
latency and low overhead continuous communications method between
clients and server (and is already used by e.g. most major social
media platforms). Therefore, this new method should be better
supported by network infrastructure as well as being more efficient.</p><p>To use the new websocket protocol, simply set the client&rsquo;s server URL
to have <code>wss://</code> scheme:</p><pre><code class=language-yaml>Client:
  server_urls:
  - wss://velociraptor.example.com:8000/
  - https://velociraptor.example.com:8000/
</code></pre><p>You can use both <code>https</code> and <code>wss</code> URLs at the same time, Velociraptor
will switch from one to the other scheme if one becomes unavailable.</p><h3 id=dynamic-dns-providers>Dynamic DNS providers</h3><p>Velociraptor has the capability to adjust DNS records by itself (AKA
Dynamic DNS). This saves users the hassle of managing a dedicated
dynamic DNS service such as <code>ddclient</code>).</p><p>Traditionally we used Google Domains as our default Dynamic DNS
provider, but Google has decided to shut down this service abruptly
forcing us to switch to alternative providers.</p><p>The 0.72 release has now switched to <code>CloudFlare</code> as our default
preferred Dynamic DNS provider. We also added <code>noip.com</code> as a second
option.</p><p>Setting up CloudFlare as your preferred dynamic DNS provider requires
the following steps:</p><ol><li>Sign into CloudFlare and buy a domain name.</li><li>go to <a href=https://dash.cloudflare.com/profile/api-tokens>https://dash.cloudflare.com/profile/api-tokens</a> to generate an
API token. Select <code>Edit Zone DNS</code> in the API Token templates.</li></ol><p><img src=cloudflare_1.png alt></p><p><img src=cloudflare_2.png alt></p><p>You will require the &ldquo;Edit&rdquo; permission on Zone DNS and include the
specific zone name you want to manage. The zone name is the domain you
purchased for example &ldquo;example.com&rdquo;. You will be able to set the
hostname under that domain, e.g. &ldquo;velociraptor.example.com&rdquo;</p><p><img src=cloudflare_3.png alt></p><p>Using this information you can now create the dyndns configuration:</p><pre><code class=language-yaml>Frontend:
  ....
  dyn_dns:
    type: cloudflare
    api_token: XXXYYYZZZ
    zone_name: example.com
</code></pre><p>Make sure the Frontend.Hostname field is set to the correct hostname
to update - for example</p><pre><code class=language-yaml>Frontend:
  hostname: velociraptor.example.com
</code></pre><p>This is the hostname that will be updated.</p><h3 id=enhanced-proxy-support>Enhanced proxy support</h3><p>Velociraptor is often deployed into complex enterprise networks. Such
networks are often locked down with complicated controls (such as MITM
inspection proxies or automated proxy configurations) which
Velociraptor needs to support.</p><p>Velociraptor already supports MITM proxies but previously had
inflexible proxy configuration. The proxy could be set or unset but
there was no finer grained control over which proxy to choose for
different URLs. This makes it difficult to deploy on changing
network topologies (such as roaming use).</p><p>The 0.72 release introduces more complex proxy condition
capabilities. It is now possible to specify which proxy to use for
which URL based on a set of regular expressions:</p><pre><code class=language-yaml>Client:
  proxy_config:
    http: http://192.168.1.1:3128/
    proxy_url_regexp:
      &quot;^https://www.google.com/&quot;: &quot;&quot;
      &quot;^https://.+example.com&quot;: &quot;https://proxy.example.com:3128/&quot;
</code></pre><p>The above configuration means to:</p><ol><li>By default connect to <code>http://192.168.1.1:3128/</code> for all URLs
(including <code>https</code>)</li><li>Except for <code>www.google.com</code> which will be connecting to directly.</li><li>Any URLs in the <code>example.com</code> domain will be forwarded through
<code>https://proxy.example.com:3128</code></li></ol><p>This proxy configuration can apply to the <code>Client</code> section or the
<code>Frontend</code> section to control the server&rsquo;s configuration.</p><p>Additionally, Velociraptor now supports a <code>Proxy Auto Configuration (PAC)</code> file. If a <code>PAC</code> file is specified, then the other
configuration directives are ignored and all configuration comes from
the PAC file. The PAC file can also be read from disk using the
<code>file://</code> URL scheme, or even provided within the configuration file
using a <code>data:</code> URL.</p><pre><code class=language-yaml>Client:
  proxy_config:
    pac: http://www.example.com/wpad.dat
</code></pre><p>Note that the PAC file must obviously be accessible without a proxy.</p><h2 id=other-notable-features>Other notable features</h2><p>Other interesting improvements include</p><h3 id=process-memory-access-on-macos>Process memory access on MacOS</h3><p>On MacOS we can now use proc_yara() to scan process memory. This
should work providing your TCT profile grant the <code>get-task-allow</code>,
<code>proc_info-allow</code> and <code>task_for_pid-allow</code> entitlements. For example
the following <code>plist</code> is needed at a minimum:</p><pre><code class=language-xml>&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
    &lt;key&gt;com.apple.springboard.debugapplications&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;get-task-allow&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;proc_info-allow&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;task_for_pid-allow&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre><h3 id=multipart-uploaders-to-http_client>Multipart uploaders to http_client()</h3><p>Sometimes servers requires uploaded files to be encoded using the
<code>mutipart/form</code> method. Previously it was possible to upload files
using the <code>http_client()</code> plugin by constructing the relevant request
in pure VQL string building operations.</p><p>However this approach is limited by available memory and is not
suitable for larger files. It is also non-intuitive for users.</p><p>This release adds the <code>files</code> parameter to the <code>http_client()</code>
plugin. This simplifies uploading multiple files and automatically
streams those files without memory buffering - allowing very large
files to be uploaded this way.</p><p>For example:</p><pre><code class=language-vql>SELECT *
FROM http_client(
  url='http://localhost:8002/test/',
  method='POST',
  files=dict(file='file.txt', key='file', path='/etc/passwd', accessor=&quot;file&quot;)
)
</code></pre><p>Here the files can be an array of dicts with the following fields:</p><ul><li>file: The name of the file that will be stored on the server</li><li>key: The name of the form element that will receive the file</li><li>path: This is an OSPath object that we open and stream into the form.</li><li>accessor: Any accessor required for the path.</li></ul><h3 id=yara-plugin-can-now-accept-compiled-rules>Yara plugin can now accept compiled rules</h3><p>The <code>yara()</code> plugin was upgraded to use Yara Version 4.5.0 as well as
support compiled yara rules. You can compile yara rules with the
<code>yarac</code> compiler to produce a binary rule file. Simply pass the
compiled binary data to the <code>yara()</code> plugin&rsquo;s <code>rules</code> parameter.</p><div class="mynotices warning"><div heading=warning><p>We do not recommend using compiled yara rule because of their
practical limitations:</p><ol><li>The compiled rules can not portable and must be used on exactly the
same version of the yara library as the compiler that created them
(Currently 4.5.0)</li><li>Compiled yara rules are much larger than the text rules.</li></ol><p>Compiled yara rules pose no benefit over text based rules, except
perhaps being more complex to decompile. This is primarily the reason
to use compiled rules - to try to hide the rules (e.g. from commercial
reasons).</p></div></div><h2 id=conclusions>Conclusions</h2><p>There are many more new features and bug fixes in the latest release.</p><p>If you like the new features, take <a href=https://github.com/Velocidex/velociraptor>Velociraptor for a
spin</a>! It is available
on GitHub under an open source license. As always please file issues
on the bug tracker or ask questions on our mailing list
<a href=mailto:velociraptor-discuss@googlegroups.com>velociraptor-discuss@googlegroups.com</a>
. You can also chat with us directly on discord
<a href=https://www.velocidex.com/discord>https://www.velocidex.com/discord</a>
.</p><footer class=footline></footer></div></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1711319563></script><script src=/js/perfect-scrollbar.min.js?1711319563></script><script src=/js/perfect-scrollbar.jquery.min.js?1711319563></script><script src=/js/jquery.sticky.js?1711319563></script><script src=/js/featherlight.min.js?1711319563></script><script src=/js/highlight.min.js?1711319563></script><script>hljs.highlightAll()</script><script src=/js/modernizr.custom-3.6.0.js?1711319563></script><script src=/js/learn.js?1711319563></script><script src=/js/hugo-learn.js?1711319563></script></body></html>